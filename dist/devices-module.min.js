var DevicesModule=function(e,t,r,n,i,a,c,o,s,u,d,l,p,f,h,v,E,m,g){"use strict";function T(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function y(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var w,R,b,N,I,A,S,D,O=T(n),k=y(i),_=T(a),x=T(c),M=T(o),C=T(s),P=T(u),G=T(l),H=y(p),L=y(f),U=y(h),F=y(v),Y=y(E),j=y(m),$=y(g);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t,r,n,i,a,c){try{var o=e[a](c),s=o.value}catch(e){return void r(e)}o.done?t(s):Promise.resolve(s).then(n,i)}function q(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function c(e){K(a,n,i,c,o,"next",e)}function o(e){K(a,n,i,c,o,"throw",e)}c(void 0)}))}}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e,t,r){return t&&B(e.prototype,t),r&&B(e,r),e}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function te(e,t,r){return(te=ee()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&X(i,r.prototype),i}).apply(null,arguments)}function re(e){var t="function"==typeof Map?new Map:void 0;return(re=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return te(e,arguments,Q(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),X(n,e)})(e)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?ne(e):t}function ae(e){var t=ee();return function(){var r,n=Q(e);if(t){var i=Q(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ie(this,r)}}function ce(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return oe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(w||(w={})),function(e){e.DEVICE="devices-module/device"}(R||(R={})),function(e){e[e.CHAR=t.DataType.CHAR]="CHAR",e[e.UNSIGNED_CHAR=t.DataType.UCHAR]="UNSIGNED_CHAR",e[e.SHORT=t.DataType.SHORT]="SHORT",e[e.UNSIGNED_SHORT=t.DataType.USHORT]="UNSIGNED_SHORT",e[e.INT=t.DataType.INT]="INT",e[e.UNSIGNED_INT=t.DataType.UINT]="UNSIGNED_INT",e[e.FLOAT=t.DataType.FLOAT]="FLOAT"}(b||(b={})),function(e){e[e.CHAR=t.DataType.CHAR]="CHAR",e[e.UNSIGNED_CHAR=t.DataType.UCHAR]="UNSIGNED_CHAR",e[e.SHORT=t.DataType.SHORT]="SHORT",e[e.UNSIGNED_SHORT=t.DataType.USHORT]="UNSIGNED_SHORT",e[e.INT=t.DataType.INT]="INT",e[e.UNSIGNED_INT=t.DataType.UINT]="UNSIGNED_INT"}(N||(N={})),function(e){e.SENDING="sending",e.COMPLETED="completed"}(I||(I={})),function(e){e.OK="ok",e.ERR="err"}(A||(A={})),function(e){e.SENSOR="sensor",e.AIR_QUALITY="air_quality",e.LIGHT_LEVEL="light_level",e.NOISE_LEVEL="noise_level",e.TEMPERATURE="temperature",e.HUMIDITY="humidity"}(S||(S={})),function(e){e.ACTOR="actor",e.SWITCH="switch"}(D||(D={}));var se,ue,de=function(e){W(n,e);var r=ae(n);function n(){var e;z(this,n);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return J(ne(e=r.call.apply(r,[this].concat(i))),"id",void 0),J(ne(e),"key",void 0),J(ne(e),"identifier",void 0),J(ne(e),"name",void 0),J(ne(e),"settable",void 0),J(ne(e),"queryable",void 0),J(ne(e),"dataType",void 0),J(ne(e),"unit",void 0),J(ne(e),"format",void 0),J(ne(e),"value",void 0),J(ne(e),"expected",void 0),J(ne(e),"pending",void 0),J(ne(e),"command",void 0),J(ne(e),"lastResult",void 0),J(ne(e),"backup",void 0),J(ne(e),"relationshipNames",void 0),J(ne(e),"device",void 0),e}return Z(n,[{key:"isAnalogSensor",get:function(){return!this.isSettable&&Object.values(b).includes(this.dataType)}},{key:"isBinarySensor",get:function(){return!this.isSettable&&[t.DataType.BOOLEAN].includes(this.dataType)}},{key:"isAnalogActor",get:function(){return this.isSettable&&Object.values(b).includes(this.dataType)}},{key:"isBinaryActor",get:function(){return this.isSettable&&[t.DataType.BOOLEAN].includes(this.dataType)}},{key:"isSwitch",get:function(){return"switch"===this.identifier}},{key:"isInteger",get:function(){return Object.values(N).includes(this.dataType)}},{key:"isFloat",get:function(){return this.dataType===t.DataType.FLOAT}},{key:"isNumber",get:function(){return Object.values(b).includes(this.dataType)}},{key:"isBoolean",get:function(){return this.dataType===t.DataType.BOOLEAN}},{key:"isString",get:function(){return this.dataType===t.DataType.STRING}},{key:"isEnum",get:function(){return this.dataType===t.DataType.ENUM}},{key:"isColor",get:function(){return this.dataType===t.DataType.COLOR}},{key:"isSettable",get:function(){return this.settable}},{key:"isQueryable",get:function(){return this.queryable}},{key:"binaryValue",get:function(){return null!==this.value&&(this.isBoolean?"boolean"==typeof this.value?this.value:["true","1","t","y","yes"].includes(this.value.toString().toLocaleLowerCase()):!!this.isEnum&&"on"===this.value)}},{key:"binaryExpected",get:function(){return null===this.expected?null:this.isBoolean?"boolean"==typeof this.expected?this.expected:["true","1","t","y","yes"].includes(this.expected.toString().toLocaleLowerCase()):!!this.isEnum&&"on"===this.expected}},{key:"analogValue",get:function(){if(null!==this.device&&this.device.hardwareManufacturer===t.HardwareManufacturer.ITEAD)switch(this.identifier){case"air_quality":return this.value>7?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.unhealthy")).toString():this.value>4?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.moderate")).toString():n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.good")).toString();case"light_level":return this.value>8?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.dusky")).toString():this.value>4?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.normal")).toString():n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.bright")).toString();case"noise_level":return this.value>6?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.noisy")).toString():this.value>3?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.normal")).toString():n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.quiet")).toString()}return this.formattedValue}},{key:"analogExpected",get:function(){if(null===this.expected)return null;if(null!==this.device&&this.device.hardwareManufacturer===t.HardwareManufacturer.ITEAD)switch(this.identifier){case"air_quality":return this.expected>7?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.unhealthy")).toString():this.expected>4?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.moderate")).toString():n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.good")).toString();case"light_level":return this.expected>8?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.dusky")).toString():this.expected>4?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.normal")).toString():n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.bright")).toString();case"noise_level":return this.expected>6?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.noisy")).toString():this.expected>3?n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.normal")).toString():n.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".values.quiet")).toString()}return this.formattedValue}},{key:"formattedValue",get:function(){var e,t,r,n=parseFloat(this.value),i="".concat(n).replace(/[^0-9+\-Ee.]/g,""),a=isFinite(+i)?+i:0,c=isFinite(2)?Math.abs(2):0,o=(c?(e=a,t=c,r=Math.pow(10,t),"".concat(Math.round(e*r)/r)):"".concat(Math.round(a))).split(".");return o[0].length>3&&(o[0]=o[0].replace(/\B(?=(?:\d{3})+(?!\d))/g," ")),(o[1]||"").length<c&&(o[1]=o[1]||"",o[1]+=new Array(c-o[1].length+1).join("0")),o.join(",")}},{key:"icon",get:function(){switch(this.identifier){case"temperature":return"thermometer-half";case"humidity":return"tint";case"air_quality":return"fan";case"light_level":return"sun";case"noise_level":return"microphone-alt";case"power":return"plug";case"current":case"voltage":return"bolt";case"energy":return"calculator"}return"chart-bar"}}],[{key:"fields",value:function(){return{id:this.string(""),key:this.string(""),identifier:this.string(""),name:this.string(null).nullable(),settable:this.boolean(!1),queryable:this.boolean(!1),dataType:this.string(""),unit:this.string(null).nullable(),format:this.string(null).nullable(),value:this.attr(null).nullable(),expected:this.attr(null).nullable(),pending:this.boolean(!1),relationshipNames:this.attr([])}}}]),n}(r.Model);!function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(se||(se={})),function(e){e.PROPERTY="devices-module/device-property"}(ue||(ue={}));var le,pe,fe,he,ve=function(e){W(a,e);var t,r,n,i=ae(a);function a(){var e;z(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=i.call.apply(i,[this].concat(r))),"type",void 0),J(ne(e),"device",void 0),J(ne(e),"deviceBackward",void 0),J(ne(e),"deviceId",void 0),e}return Z(a,[{key:"title",get:function(){return null!==this.name?this.name:null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")&&a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".title")).toString().includes("devices.vendors.")?a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".title")).toString():O.default(this.identifier)}}],[{key:"entity",get:function(){return"device_property"}},{key:"fields",value:function(){return Object.assign(de.fields(),{type:this.string(ue.PROPERTY),device:this.belongsTo(_e,"id"),deviceBackward:this.hasOne(_e,"id","deviceId"),deviceId:this.string("")})}},{key:"get",value:(n=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("get",{device:t,id:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetch",value:(r=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("fetch",{device:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"edit",value:(t=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("edit",{property:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"transmitData",value:function(e,t){return a.dispatch("transmitData",{property:e,value:t})}},{key:"reset",value:function(){a.dispatch("reset")}}]),a}(de);!function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(le||(le={})),function(e){e.CONFIGURATION="devices-module/device-configuration"}(pe||(pe={})),function(e){e[e.CHAR=t.DataType.CHAR]="CHAR",e[e.UNSIGNED_CHAR=t.DataType.UCHAR]="UNSIGNED_CHAR",e[e.SHORT=t.DataType.SHORT]="SHORT",e[e.UNSIGNED_SHORT=t.DataType.USHORT]="UNSIGNED_SHORT",e[e.INT=t.DataType.INT]="INT",e[e.UNSIGNED_INT=t.DataType.UINT]="UNSIGNED_INT",e[e.FLOAT=t.DataType.FLOAT]="FLOAT"}(fe||(fe={})),function(e){e[e.CHAR=t.DataType.CHAR]="CHAR",e[e.UNSIGNED_CHAR=t.DataType.UCHAR]="UNSIGNED_CHAR",e[e.SHORT=t.DataType.SHORT]="SHORT",e[e.UNSIGNED_SHORT=t.DataType.USHORT]="UNSIGNED_SHORT",e[e.INT=t.DataType.INT]="INT",e[e.UNSIGNED_INT=t.DataType.UINT]="UNSIGNED_INT"}(he||(he={}));var Ee,me,ge,Te,ye=function(e){W(n,e);var r=ae(n);function n(){var e;z(this,n);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return J(ne(e=r.call.apply(r,[this].concat(i))),"id",void 0),J(ne(e),"key",void 0),J(ne(e),"identifier",void 0),J(ne(e),"name",void 0),J(ne(e),"comment",void 0),J(ne(e),"value",void 0),J(ne(e),"default",void 0),J(ne(e),"dataType",void 0),J(ne(e),"min",void 0),J(ne(e),"max",void 0),J(ne(e),"step",void 0),J(ne(e),"values",void 0),J(ne(e),"relationshipNames",void 0),e}return Z(n,[{key:"isInteger",get:function(){return Object.values(he).includes(this.dataType)}},{key:"isFloat",get:function(){return this.dataType===t.DataType.FLOAT}},{key:"isNumber",get:function(){return Object.values(fe).includes(this.dataType)}},{key:"isBoolean",get:function(){return this.dataType===t.DataType.BOOLEAN}},{key:"isString",get:function(){return this.dataType===t.DataType.STRING}},{key:"isSelect",get:function(){return this.dataType===t.DataType.ENUM}}],[{key:"fields",value:function(){return{id:this.string(""),key:this.string(""),identifier:this.string(""),name:this.string(null).nullable(),comment:this.string(null).nullable(),value:this.attr(null).nullable(),default:this.attr(null).nullable(),dataType:this.string(""),min:this.number(null).nullable(),max:this.number(null).nullable(),step:this.number(null).nullable(),values:this.attr([]),relationshipNames:this.attr([])}}}]),n}(r.Model),we=function(e){W(a,e);var t,r,n,i=ae(a);function a(){var e;z(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=i.call.apply(i,[this].concat(r))),"type",void 0),J(ne(e),"device",void 0),J(ne(e),"deviceBackward",void 0),J(ne(e),"deviceId",void 0),e}return Z(a,[{key:"title",get:function(){return null!==this.name?this.name:null===this.device||this.device.isCustomModel||!Object.prototype.hasOwnProperty.call(a.store(),"$i18n")||a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".identifier.").concat(this.identifier,".title")).toString().includes("devices.vendors.")?O.default(this.identifier):a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(this.identifier,".title")).toString()}},{key:"description",get:function(){return null!==this.comment?this.comment:null===this.device||this.device.isCustomModel||!Object.prototype.hasOwnProperty.call(a.store(),"$i18n")||a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(this.identifier,".description")).toString().includes("devices.vendors.")?null:a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(this.identifier,".description")).toString()}},{key:"selectValues",get:function(){var e=this;if(!this.isSelect)throw new Error("This field is not allowed for entity type ".concat(this.type));if(null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")){var t=[];return this.values.forEach((function(r){var n;t.push({value:r.value,name:a.store().$i18n.t("devices.vendors.".concat(null===(n=e.device)||void 0===n?void 0:n.hardwareManufacturer,".configuration.").concat(e.identifier,".values.").concat(r.name)).toString()})})),t}return this.values}},{key:"formattedValue",get:function(){var e=this;return this.isSelect&&null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")&&this.values.forEach((function(t){var r,n;if(t.value==e.value)return a.store().$i18n.t("devices.vendors.".concat(null===(r=e.device)||void 0===r?void 0:r.hardwareManufacturer,".configuration.").concat(e.identifier,".values.").concat(t.name)).toString().includes("devices.vendors.")?e.value:a.store().$i18n.t("devices.vendors.".concat(null===(n=e.device)||void 0===n?void 0:n.hardwareManufacturer,".configuration.").concat(e.identifier,".values.").concat(t.name))})),this.value}}],[{key:"entity",get:function(){return"device_configuration"}},{key:"fields",value:function(){return Object.assign(ye.fields(),{type:this.string(pe.CONFIGURATION),device:this.belongsTo(_e,"id"),deviceBackward:this.hasOne(_e,"id","deviceId"),deviceId:this.string("")})}},{key:"get",value:(n=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("get",{device:t,id:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetch",value:(r=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("fetch",{device:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"edit",value:(t=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("edit",{property:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"transmitData",value:function(e,t){return a.dispatch("transmitData",{property:e,value:t})}},{key:"reset",value:function(){a.dispatch("reset")}}]),a}(ye);!function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(Ee||(Ee={})),function(e){e.CHANNEL="devices-module/channel"}(me||(me={})),function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(ge||(ge={})),function(e){e.PROPERTY="devices-module/channel-property"}(Te||(Te={}));var Re,be,Ne=function(e){W(a,e);var t,r,n,i=ae(a);function a(){var e;z(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=i.call.apply(i,[this].concat(r))),"type",void 0),J(ne(e),"channel",void 0),J(ne(e),"channelBackward",void 0),J(ne(e),"channelId",void 0),e}return Z(a,[{key:"title",get:function(){if(null!==this.name)return this.name;if(null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")){if(this.identifier.includes("_")){var e=this.identifier.substring(0,this.identifier.indexOf("_")),t=parseInt(this.identifier.substring(this.identifier.indexOf("_")+1),10);if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".properties.").concat(e,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".properties.").concat(e,".title"),{number:t}).toString();if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(e,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(e,".title"),{number:t}).toString()}if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".properties.").concat(this.identifier,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".properties.").concat(this.identifier,".title")).toString();if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".properties.").concat(this.identifier,".title")).toString()}return O.default(this.identifier)}},{key:"device",get:function(){if(null===this.channel){var e=Ae.query().where("id",this.channelId).first();return null!==e?_e.query().where("id",e.deviceId).first():null}return _e.query().where("id",this.channel.deviceId).first()}}],[{key:"entity",get:function(){return"channel_property"}},{key:"fields",value:function(){return Object.assign(de.fields(),{type:this.string(Te.PROPERTY),channel:this.belongsTo(Ae,"id"),channelBackward:this.hasOne(Ae,"id","channelId"),channelId:this.string("")})}},{key:"get",value:(n=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("get",{channel:t,id:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetch",value:(r=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("fetch",{channel:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"edit",value:(t=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("edit",{property:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"transmitData",value:function(e,t){return a.dispatch("transmitData",{property:e,value:t})}},{key:"reset",value:function(){a.dispatch("reset")}}]),a}(de),Ie=function(e){W(a,e);var t,r,n,i=ae(a);function a(){var e;z(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=i.call.apply(i,[this].concat(r))),"type",void 0),J(ne(e),"channel",void 0),J(ne(e),"channelBackward",void 0),J(ne(e),"channelId",void 0),e}return Z(a,[{key:"title",get:function(){if(null!==this.name)return this.name;if(null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")){if(this.identifier.includes("_")){var e=this.identifier.substring(0,this.identifier.indexOf("_")).toLowerCase(),t=parseInt(this.identifier.substring(this.identifier.indexOf("_")+1),10);if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".configuration.").concat(e,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".configuration.").concat(e,".title"),{number:t}).toString();if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(e,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(e,".title"),{number:t}).toString()}if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".configuration.").concat(this.identifier,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".configuration.").concat(this.identifier,".title")).toString();if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(this.identifier,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(this.identifier,".title")).toString()}return O.default(this.identifier)}},{key:"description",get:function(){if(null!==this.comment)return this.comment;if(null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")){if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".configuration.").concat(this.identifier,".description")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".devices.").concat(this.device.hardwareModel,".configuration.").concat(this.identifier,".description")).toString();if(!a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(this.identifier,".description")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(this.device.hardwareManufacturer,".configuration.").concat(this.identifier,".description")).toString()}return null}},{key:"selectValues",get:function(){var e=this;if(!this.isSelect)throw new Error("This field is not allowed for entity type ".concat(this.type));if(null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")){var t=[];return this.values.forEach((function(r){var n,i,c,o,s,u=r.name;if(a.store().$i18n.t("devices.vendors.".concat(null===(n=e.device)||void 0===n?void 0:n.hardwareManufacturer,".devices.").concat(null===(i=e.device)||void 0===i?void 0:i.hardwareModel,".configuration.").concat(e.identifier,".values.").concat(r.name)).toString().includes("devices.vendors.")){if(!a.store().$i18n.t("devices.vendors.".concat(null===(c=e.device)||void 0===c?void 0:c.hardwareManufacturer,".configuration.").concat(e.identifier,".values.").concat(r.name)).toString().includes("devices.vendors.")){var d;u=a.store().$i18n.t("devices.vendors.".concat(null===(d=e.device)||void 0===d?void 0:d.hardwareManufacturer,".configuration.").concat(e.identifier,".values.").concat(r.name)).toString()}}else u=a.store().$i18n.t("devices.vendors.".concat(null===(o=e.device)||void 0===o?void 0:o.hardwareManufacturer,".devices.").concat(null===(s=e.device)||void 0===s?void 0:s.hardwareModel,".configuration.").concat(e.identifier,".values.").concat(r.name)).toString();t.push({value:r.value,name:u})})),t}return this.values}},{key:"formattedValue",get:function(){var e=this;return this.isSelect&&null!==this.device&&!this.device.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")&&this.values.forEach((function(t){var r,n,i,c,o,s;if(t.value==e.value)return a.store().$i18n.t("devices.vendors.".concat(null===(r=e.device)||void 0===r?void 0:r.hardwareManufacturer,".devices.").concat(null===(n=e.device)||void 0===n?void 0:n.hardwareModel,".configuration.").concat(e.identifier,".values.").concat(t.name)).toString().includes("devices.vendors.")?a.store().$i18n.t("devices.vendors.".concat(null===(i=e.device)||void 0===i?void 0:i.hardwareManufacturer,".configuration.").concat(e.identifier,".values.").concat(t.name)).toString().includes("devices.vendors.")?e.value:a.store().$i18n.t("devices.vendors.".concat(null===(c=e.device)||void 0===c?void 0:c.hardwareManufacturer,".configuration.").concat(e.identifier,".values.").concat(t.name)).toString():a.store().$i18n.t("devices.vendors.".concat(null===(o=e.device)||void 0===o?void 0:o.hardwareManufacturer,".devices.").concat(null===(s=e.device)||void 0===s?void 0:s.hardwareModel,".configuration.").concat(e.identifier,".values.").concat(t.name)).toString()})),this.value}},{key:"device",get:function(){if(null===this.channel){var e=Ae.query().where("id",this.channelId).first();return null!==e?_e.query().where("id",e.deviceId).first():null}return _e.query().where("id",this.channel.deviceId).first()}}],[{key:"entity",get:function(){return"channel_configuration"}},{key:"fields",value:function(){return Object.assign(ye.fields(),{type:this.string(""),channel:this.belongsTo(Ae,"id"),channelBackward:this.hasOne(Ae,"id","channelId"),channelId:this.string("")})}},{key:"get",value:(n=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("get",{channel:t,id:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetch",value:(r=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("fetch",{channel:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"edit",value:(t=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("edit",{property:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"transmitData",value:function(e,t){return a.dispatch("transmitData",{property:e,value:t})}},{key:"reset",value:function(){a.dispatch("reset")}}]),a}(ye),Ae=function(e){W(a,e);var t,r,n,i=ae(a);function a(){var e;z(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=i.call.apply(i,[this].concat(r))),"id",void 0),J(ne(e),"type",void 0),J(ne(e),"key",void 0),J(ne(e),"identifier",void 0),J(ne(e),"name",void 0),J(ne(e),"comment",void 0),J(ne(e),"control",void 0),J(ne(e),"relationshipNames",void 0),J(ne(e),"properties",void 0),J(ne(e),"configuration",void 0),J(ne(e),"device",void 0),J(ne(e),"deviceBackward",void 0),J(ne(e),"deviceId",void 0),e}return Z(a,[{key:"title",get:function(){if(null!==this.name)return this.name;var e=_e.query().where("id",this.deviceId).first();if(null!==e&&!e.isCustomModel&&Object.prototype.hasOwnProperty.call(a.store(),"$i18n")){if(this.identifier.includes("_")){var t=this.identifier.substring(0,this.identifier.indexOf("_")),r=parseInt(this.identifier.substring(this.identifier.indexOf("_")+1),10);if(!a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".devices.").concat(e.hardwareModel,".channels.").concat(t,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".devices.").concat(e.hardwareModel,".channels.").concat(t,".title"),{number:r+1}).toString();if(!a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".channels.").concat(t,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".channels.").concat(t,".title"),{number:r+1}).toString()}if(!a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".devices.").concat(e.hardwareModel,".channels.").concat(this.identifier,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".devices.").concat(e.hardwareModel,".channels.").concat(this.identifier,".title")).toString();if(!a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".channels.").concat(this.identifier,".title")).toString().includes("devices.vendors."))return a.store().$i18n.t("devices.vendors.".concat(e.hardwareManufacturer,".channels.").concat(this.identifier,".title")).toString()}return O.default(this.identifier)}}],[{key:"entity",get:function(){return"channel"}},{key:"fields",value:function(){return{id:this.string(""),type:this.string(me.CHANNEL),key:this.string(""),identifier:this.string(""),name:this.string(null).nullable(),comment:this.string(null).nullable(),control:this.attr([]),relationshipNames:this.attr([]),properties:this.hasMany(Ne,"channelId"),configuration:this.hasMany(Ie,"channelId"),device:this.belongsTo(_e,"id"),deviceBackward:this.hasOne(_e,"id","deviceId"),deviceId:this.string("")}}},{key:"get",value:(n=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("get",{device:t,id:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetch",value:(r=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("fetch",{device:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"edit",value:(t=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("edit",{channel:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"transmitCommand",value:function(e,t){return a.dispatch("transmitCommand",{channel:e,command:t})}},{key:"reset",value:function(){a.dispatch("reset")}}]),a}(r.Model);!function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(Re||(Re={})),function(e){e.CONNECTOR="devices-module/device-connector"}(be||(be={}));var Se,De,Oe=function(e){W(a,e);var t,r,n,i=ae(a);function a(){var e;z(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=i.call.apply(i,[this].concat(r))),"id",void 0),J(ne(e),"type",void 0),J(ne(e),"name",void 0),J(ne(e),"enabled",void 0),J(ne(e),"control",void 0),J(ne(e),"relationshipNames",void 0),J(ne(e),"devices",void 0),J(ne(e),"address",void 0),J(ne(e),"serialInterface",void 0),J(ne(e),"baudRate",void 0),J(ne(e),"server",void 0),J(ne(e),"port",void 0),J(ne(e),"securedPort",void 0),J(ne(e),"username",void 0),J(ne(e),"password",void 0),e}return Z(a,[{key:"isEnabled",get:function(){return this.enabled}},{key:"icon",get:function(){return"magic"}}],[{key:"entity",get:function(){return"connector"}},{key:"fields",value:function(){return{id:this.string(""),type:this.string(""),name:this.string(""),enabled:this.boolean(!0),relationshipNames:this.attr([]),devices:this.hasMany(ke,"connectorId"),address:this.number(null).nullable(),serialInterface:this.string(null).nullable(),baudRate:this.number(null).nullable(),server:this.string(null).nullable(),port:this.number(null).nullable(),securedPort:this.number(null).nullable(),username:this.string(null).nullable(),password:this.string(null).nullable()}}},{key:"get",value:(n=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("get",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"fetch",value:(r=q(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("fetch");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"edit",value:(t=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dispatch("edit",{connector:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"transmitCommand",value:function(e,t){return a.dispatch("transmitCommand",{connector:e,command:t})}},{key:"reset",value:function(){a.dispatch("reset")}}]),a}(r.Model),ke=function(e){W(o,e);var t,r,n,i,a,c=ae(o);function o(){var e;z(this,o);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=c.call.apply(c,[this].concat(r))),"id",void 0),J(ne(e),"type",void 0),J(ne(e),"draft",void 0),J(ne(e),"address",void 0),J(ne(e),"maxPacketLength",void 0),J(ne(e),"descriptionSupport",void 0),J(ne(e),"settingsSupport",void 0),J(ne(e),"configuredKeyLength",void 0),J(ne(e),"pubSubPubSupport",void 0),J(ne(e),"pubSubSubSupport",void 0),J(ne(e),"pubSubSubMaxSubscriptions",void 0),J(ne(e),"pubSubSubMaxConditions",void 0),J(ne(e),"pubSubSubMaxActions",void 0),J(ne(e),"username",void 0),J(ne(e),"password",void 0),J(ne(e),"relationshipNames",void 0),J(ne(e),"device",void 0),J(ne(e),"deviceBackward",void 0),J(ne(e),"connector",void 0),J(ne(e),"connectorBackward",void 0),J(ne(e),"deviceId",void 0),J(ne(e),"connectorId",void 0),e}return Z(o,null,[{key:"entity",get:function(){return"device_connector"}},{key:"fields",value:function(){return{id:this.string(""),type:this.string(be.CONNECTOR),draft:this.boolean(!1),address:this.number(0),maxPacketLength:this.number(0),descriptionSupport:this.boolean(!1),settingsSupport:this.boolean(!1),configuredKeyLength:this.number(0),pubSubPubSupport:this.boolean(!1),pubSubSubSupport:this.boolean(!1),pubSubSubMaxSubscriptions:this.number(0),pubSubSubMaxConditions:this.number(0),pubSubSubMaxActions:this.number(0),username:this.string(""),password:this.string(""),relationshipNames:this.attr([]),device:this.belongsTo(_e,"id"),deviceBackward:this.hasOne(_e,"id","deviceId"),connector:this.belongsTo(Oe,"id"),connectorBackward:this.hasOne(Oe,"id","connectorId"),deviceId:this.string(""),connectorId:this.string("")}}},{key:"get",value:(a=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.dispatch("get",{device:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"add",value:(i=q(regeneratorRuntime.mark((function e(t,r,n,i){var a,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(c.length>4&&void 0!==c[4])||c[4],e.next=3,o.dispatch("add",{id:i,draft:a,device:t,connector:r,data:n});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e,t,r,n){return i.apply(this,arguments)})},{key:"edit",value:(n=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.dispatch("edit",{connector:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"save",value:(r=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.dispatch("save",{connector:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"remove",value:(t=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.dispatch("remove",{connector:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){o.dispatch("reset")}}]),o}(r.Model),_e=function(e){W(u,e);var r,n,i,a,c,o,s=ae(u);function u(){var e;z(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(ne(e=s.call.apply(s,[this].concat(r))),"id",void 0),J(ne(e),"type",void 0),J(ne(e),"draft",void 0),J(ne(e),"parentId",void 0),J(ne(e),"key",void 0),J(ne(e),"identifier",void 0),J(ne(e),"name",void 0),J(ne(e),"comment",void 0),J(ne(e),"state",void 0),J(ne(e),"enabled",void 0),J(ne(e),"hardwareModel",void 0),J(ne(e),"hardwareManufacturer",void 0),J(ne(e),"hardwareVersion",void 0),J(ne(e),"macAddress",void 0),J(ne(e),"firmwareManufacturer",void 0),J(ne(e),"firmwareVersion",void 0),J(ne(e),"control",void 0),J(ne(e),"owner",void 0),J(ne(e),"relationshipNames",void 0),J(ne(e),"children",void 0),J(ne(e),"channels",void 0),J(ne(e),"properties",void 0),J(ne(e),"configuration",void 0),J(ne(e),"connector",void 0),e}return Z(u,[{key:"isEnabled",get:function(){return this.enabled}},{key:"isReady",get:function(){return this.state===t.DeviceConnectionState.READY||this.state===t.DeviceConnectionState.RUNNING}},{key:"icon",get:function(){if(this.hardwareManufacturer===t.HardwareManufacturer.ITEAD)switch(this.hardwareModel){case t.DeviceModel.SONOFF_SC:return"thermometer-half";case t.DeviceModel.SONOFF_POW:case t.DeviceModel.SONOFF_POW_R2:return"calculator"}return"plug"}},{key:"title",get:function(){if(null!==this.name)return this.name;if(Object.prototype.hasOwnProperty.call(u.store(),"$i18n")){if(this.isCustomModel)return O.default(this.identifier);if(!u.store().$i18n.t("devices.vendors.".concat(this.hardwareManufacturer,".devices.").concat(this.hardwareModel,".title")).toString().includes("devices.vendors."))return u.store().$i18n.t("devices.vendors.".concat(this.hardwareManufacturer,".devices.").concat(this.hardwareModel,".title")).toString()}return O.default(this.identifier)}},{key:"hasComment",get:function(){return null!==this.comment&&""!==this.comment}},{key:"isCustomModel",get:function(){return this.hardwareModel===t.DeviceModel.CUSTOM}}],[{key:"entity",get:function(){return"device"}},{key:"fields",value:function(){return{id:this.string(""),type:this.string(R.DEVICE),draft:this.boolean(!1),parentId:this.string(null).nullable(),key:this.string(""),identifier:this.string(""),name:this.string(null).nullable(),comment:this.string(null).nullable(),state:this.string(t.DeviceConnectionState.UNKNOWN),enabled:this.boolean(!1),hardwareModel:this.string(t.DeviceModel.CUSTOM),hardwareManufacturer:this.string(t.HardwareManufacturer.GENERIC),hardwareVersion:this.string(null).nullable(),macAddress:this.string(null).nullable(),firmwareManufacturer:this.string(t.FirmwareManufacturer.GENERIC),firmwareVersion:this.string(null).nullable(),control:this.attr([]),owner:this.string(null).nullable(),relationshipNames:this.attr([]),children:this.hasMany(u,"parentId"),channels:this.hasMany(Ae,"deviceId"),properties:this.hasMany(ve,"deviceId"),configuration:this.hasMany(we,"deviceId"),connector:this.hasOne(ke,"deviceId")}}},{key:"get",value:(o=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.dispatch("get",{id:t,includeChannels:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"fetch",value:(c=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.dispatch("fetch",{includeChannels:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"add",value:(a=q(regeneratorRuntime.mark((function e(t,r){var n,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>2&&void 0!==i[2])||i[2],e.next=3,u.dispatch("add",{id:r,draft:n,data:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"edit",value:(i=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.dispatch("edit",{device:t,data:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"save",value:(n=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.dispatch("save",{device:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"remove",value:(r=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.dispatch("remove",{device:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"transmitCommand",value:function(e,t){return u.dispatch("transmitCommand",{device:e,command:t})}},{key:"reset",value:function(){u.dispatch("reset")}}]),u}(r.Model),xe=function(e){W(r,e);var t=ae(r);function r(e,n){var i;z(this,r);for(var a=arguments.length,c=new Array(a>2?a-2:0),o=2;o<a;o++)c[o-2]=arguments[o];return J(ne(i=t.call.apply(t,[this].concat(c))),"type",void 0),J(ne(i),"exception",void 0),Error.captureStackTrace&&Error.captureStackTrace(ne(i),r),i.type=e,i.exception=n,i}return r}(re(Error)),Me=function(e){W(r,e);var t=ae(r);function r(){return z(this,r),t.apply(this,arguments)}return r}(xe),Ce=function(e){W(r,e);var t=ae(r);function r(){return z(this,r),t.apply(this,arguments)}return r}(xe);!function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(Se||(Se={})),function(e){e.CONFIGURATION="devices-module/channel-configuration"}(De||(De={}));var Pe,Ge,He,Le,Ue,Fe,Ye,je,$e,Ve,Ke=function(e){W(r,e);var t=ae(r);function r(){return z(this,r),t.apply(this,arguments)}return Z(r,[{key:"getAttributes",value:function(e){var t=["id","$id","type","draft","relationshipNames"];e.type===me.CHANNEL||e.type===ue.PROPERTY||e.type===pe.CONFIGURATION||e.type===be.CONNECTOR?(t.push("deviceId"),t.push("device"),t.push("device_backward")):e.type===Te.PROPERTY||e.type===De.CONFIGURATION?(t.push("channelId"),t.push("channel"),t.push("channel_backward")):e.type===be.CONNECTOR&&(t.push("connectorId"),t.push("connector"),t.push("connector_backward")),Array.isArray(e.relationshipNames)&&t.push.apply(t,ce(e.relationshipNames));var r={};return Object.keys(e).forEach((function(n){if(!t.includes(n)){var i=n.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())})),a=e[n];"object"===V(a)&&null!==a&&(a={},Object.keys(e[n]).forEach((function(t){var r=t.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));Object.assign(a,J({},r,e[n][t]))}))),r[i]=a}})),r}},{key:"getRelationships",value:function(e){if(!Object.prototype.hasOwnProperty.call(e,"relationshipNames")||!Array.isArray(e.relationshipNames))return{};var t=e.relationshipNames,r={};if(t.forEach((function(t){var n=t.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));void 0!==e[t]&&(Array.isArray(e[t])?r[n]=e[t].map((function(e){return{id:e.id,type:e.type}})):"object"===V(e[t])&&null!==e[t]&&(r[n]={id:e[t].id,type:e[t].type}))})),Object.prototype.hasOwnProperty.call(e,"deviceId")){var n=_e.find(e.deviceId);null!==n&&(r.device={id:n.id,type:n.type})}if(Object.prototype.hasOwnProperty.call(e,"channelId")){var i=Ae.find(e.deviceId);null!==i&&(r.channel={id:i.id,type:i.type})}if(Object.prototype.hasOwnProperty.call(e,"connectorId")){var a=Oe.find(e.connectorId);null!==a&&(r.connector={id:a.id,type:a.type})}return r}}]),r}(a.ModelPropertiesMapper),qe=function(e){W(r,e);var t=ae(r);function r(){var e;z(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return J(ne(e=t.call.apply(t,[this].concat(i))),"caseRegExp","_([a-z0-9])"),e}return Z(r,[{key:"createModel",value:function(e){return{type:e}}},{key:"setId",value:function(e,t){Object.assign(e,{id:t})}},{key:"setAttributes",value:function(e,t){var r=new RegExp(this.caseRegExp,"g");Object.keys(t).forEach((function(n){var i=n.replace(r,(function(e){return e[1].toUpperCase()})),a=t[n];"object"===V(a)&&null!==a&&(a={},Object.keys(t[n]).forEach((function(e){var i=e.replace(r,(function(e){return e[1].toUpperCase()}));Object.assign(a,J({},i,t[n][e]))}))),"control"===n&&(a=Object.values(t[n])),Object.assign(e,J({},i,a))})),Object.assign(e,{draft:!1})}},{key:"setRelationships",value:function(e,t){var r=this;Object.keys(t).forEach((function(n){var i=new RegExp(r.caseRegExp,"g"),a=n.replace(i,(function(e){return e[1].toUpperCase()}));if("function"==typeof t[n])d.defineRelationGetter(e,n,t[n]);else{var c=G.default(t[n]);Array.isArray(c)?Object.assign(e,J({},a,c.map((function(e){var t=e;return t=r.transformDevice(t),t=r.transformChannel(t)})))):C.default(c,"type")===R.DEVICE?Object.assign(e,{deviceId:C.default(c,"id")}):C.default(c,"type")===me.CHANNEL?Object.assign(e,{channelId:C.default(c,"id")}):Object.assign(e,J({},a,c))}}));var n=Object.keys(t),i=e.relationshipNames;i&&i.length?Object.assign(e,J({},"relationshipNames",[].concat(ce(i),ce(n)).filter((function(e,t,r){return r.indexOf(e)===t})))):Object.assign(e,J({},"relationshipNames",n))}},{key:"transformDevice",value:function(e){return Object.prototype.hasOwnProperty.call(e,"device")&&(Object.assign(e,{deviceId:e.device.id}),Reflect.deleteProperty(e,"device")),e}},{key:"transformChannel",value:function(e){return Object.prototype.hasOwnProperty.call(e,"channel")&&(Object.assign(e,{channelId:e.channel.id}),Reflect.deleteProperty(e,"channel")),e}}]),r}(a.JsonPropertiesMapper),ze="/".concat(t.ModulePrefix.MODULE_DEVICES_PREFIX),Be=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),Ze={dataTransformer:function(e){return Be.deserialize(e.data)}},Je=new x.default,We={semaphore:{fetching:{items:!1,item:[]},creating:[],updating:[],deleting:[]},firstLoad:!1},Qe={state:function(){return We},getters:{firstLoadFinished:function(e){return function(){return!!e.firstLoad}},getting:function(e){return function(t){return e.semaphore.fetching.item.includes(t)}},fetching:function(e){return function(){return!!e.semaphore.fetching.items}}},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:w.GETTING,id:t.id}),r.prev=4,r.next=7,_e.api().get("".concat(ze,"/v1/devices/").concat(t.id,"?include=properties,configuration,connector"),Ze);case 7:if(!t.includeChannels){r.next=12;break}if(null===(a=_e.find(t.id))){r.next=12;break}return r.next=12,Ae.fetch(a);case 12:return r.abrupt("return",!0);case 15:throw r.prev=15,r.t0=r.catch(4),new Me("devices-module.devices.fetch.failed",r.t0,"Fetching devices failed.");case 18:return r.prev=18,i("CLEAR_SEMAPHORE",{type:w.GETTING,id:t.id}),r.finish(18);case 21:case"end":return r.stop()}}),r,null,[[4,15,18,21]])})))()},fetch:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.items){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:w.FETCHING}),r.prev=4,r.next=7,_e.api().get("".concat(ze,"/v1/devices?include=properties,configuration,connector"),Ze);case 7:if(!t.includeChannels){r.next=15;break}return r.next=10,_e.all();case 10:return a=r.sent,c=[],a.forEach((function(e){c.push(Ae.fetch(e))})),r.next=15,Promise.all(c);case 15:return i("SET_FIRST_LOAD",!0),r.abrupt("return",!0);case 19:throw r.prev=19,r.t0=r.catch(4),new Me("devices-module.devices.fetch.failed",r.t0,"Fetching devices failed.");case 22:return r.prev=22,i("CLEAR_SEMAPHORE",{type:w.FETCHING}),r.finish(22);case 25:case"end":return r.stop()}}),r,null,[[4,19,22,25]])})))()},add:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,i=void 0!==t.id&&null!==t.id&&""!==t.id?t.id:M.default.v4().toString(),a=void 0!==t.draft&&t.draft,n("SET_SEMAPHORE",{type:w.CREATING,id:i}),r.prev=4,r.next=7,_e.insert({data:Object.assign({},t.data,{id:i,draft:a})});case 7:r.next=13;break;case 9:throw r.prev=9,r.t0=r.catch(4),n("CLEAR_SEMAPHORE",{type:w.CREATING,id:i}),new Ce("devices-module.devices.create.failed",r.t0,"Create new device failed.");case 13:if(null!==(c=_e.find(i))){r.next=19;break}return r.next=17,_e.delete(i);case 17:throw n("CLEAR_SEMAPHORE",{type:w.CREATING,id:i}),new Error("devices-module.devices.create.failed");case 19:if(!a){r.next=24;break}return n("CLEAR_SEMAPHORE",{type:w.CREATING,id:i}),r.abrupt("return",_e.find(i));case 24:return r.prev=24,r.next=27,_e.api().post("".concat(ze,"/v1/devices?include=properties,configuration,connector"),Be.serialize({stuff:c}),Ze);case 27:return r.abrupt("return",_e.find(i));case 30:return r.prev=30,r.t1=r.catch(24),r.next=34,_e.delete(i);case 34:throw new Me("devices-module.devices.create.failed",r.t1,"Create new device failed.");case 35:return r.prev=35,n("CLEAR_SEMAPHORE",{type:w.CREATING,id:i}),r.finish(35);case 38:case"end":return r.stop()}}),r,null,[[4,9],[24,30,35,38]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.device.id)){r.next=3;break}throw new Error("devices-module.devices.update.inProgress");case 3:if(_e.query().where("id",t.device.id).exists()){r.next=5;break}throw new Error("devices-module.devices.update.failed");case 5:return i("SET_SEMAPHORE",{type:w.UPDATING,id:t.device.id}),r.prev=6,r.next=9,_e.update({where:t.device.id,data:t.data});case 9:r.next=14;break;case 11:throw r.prev=11,r.t0=r.catch(6),new Ce("devices-module.devices.update.failed",r.t0,"Edit device failed.");case 14:if(null!==(a=_e.find(t.device.id))){r.next=20;break}return r.next=18,_e.get(t.device.id,!1);case 18:throw i("CLEAR_SEMAPHORE",{type:w.UPDATING,id:t.device.id}),new Error("devices-module.devices.update.failed");case 20:if(!a.draft){r.next=25;break}return i("CLEAR_SEMAPHORE",{type:w.UPDATING,id:t.device.id}),r.abrupt("return",_e.find(t.device.id));case 25:return r.prev=25,r.next=28,_e.api().patch("".concat(ze,"/v1/devices/").concat(a.id,"?include=properties,configuration,connector"),Be.serialize({stuff:a}),Ze);case 28:return r.abrupt("return",_e.find(t.device.id));case 31:return r.prev=31,r.t1=r.catch(25),r.next=35,_e.get(t.device.id,!1);case 35:throw new Me("devices-module.devices.update.failed",r.t1,"Edit device failed.");case 36:return r.prev=36,i("CLEAR_SEMAPHORE",{type:w.UPDATING,id:t.device.id}),r.finish(36);case 39:case"end":return r.stop()}}),r,null,[[6,11],[25,31,36,39]])})))()},save:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.device.id)){r.next=3;break}throw new Error("devices-module.devices.save.inProgress");case 3:if(_e.query().where("id",t.device.id).where("draft",!0).exists()){r.next=5;break}throw new Error("devices-module.devices.save.failed");case 5:if(i("SET_SEMAPHORE",{type:w.UPDATING,id:t.device.id}),null!==(a=_e.find(t.device.id))){r.next=10;break}throw i("CLEAR_SEMAPHORE",{type:w.UPDATING,id:t.device.id}),new Error("devices-module.devices.save.failed");case 10:return r.prev=10,r.next=13,_e.api().post("".concat(ze,"/v1/devices?include=properties,configuration,connector"),Be.serialize({stuff:a}),Ze);case 13:return r.abrupt("return",_e.find(t.device.id));case 16:throw r.prev=16,r.t0=r.catch(10),new Me("devices-module.devices.save.failed",r.t0,"Save draft device failed.");case 19:return r.prev=19,i("CLEAR_SEMAPHORE",{type:w.UPDATING,id:t.device.id}),r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[10,16,19,22]])})))()},remove:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.deleting.includes(t.device.id)){r.next=3;break}throw new Error("devices-module.devices.delete.inProgress");case 3:if(_e.query().where("id",t.device.id).exists()){r.next=5;break}return r.abrupt("return",!0);case 5:return i("SET_SEMAPHORE",{type:w.DELETING,id:t.device.id}),r.prev=6,r.next=9,_e.delete(t.device.id);case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:w.DELETING,id:t.device.id}),new Ce("devices-module.devices.delete.failed",r.t0,"Delete device failed.");case 15:if(!t.device.draft){r.next=20;break}return i("CLEAR_SEMAPHORE",{type:w.DELETING,id:t.device.id}),r.abrupt("return",!0);case 20:return r.prev=20,r.next=23,_e.api().delete("".concat(ze,"/v1/devices/").concat(t.device.id),{save:!1});case 23:return r.abrupt("return",!0);case 26:return r.prev=26,r.t1=r.catch(20),r.next=30,_e.get(t.device.id,!1);case 30:throw new Ce("devices-module.devices.delete.failed",r.t1,"Delete device failed.");case 31:return r.prev=31,i("CLEAR_SEMAPHORE",{type:w.DELETING,id:t.device.id}),r.finish(31);case 34:case"end":return r.stop()}}),r,null,[[6,11],[20,26,31,34]])})))()},transmitCommand:function(e,r){if(!_e.query().where("id",r.device.id).exists())throw new Error("devices-module.device.transmit.failed");return new Promise((function(e,n){_e.wamp().call({routing_key:t.DevicesModule.DEVICES_CONTROLS,origin:_e.$devicesModuleOrigin,data:{control:r.command,device:r.device.key}}).then((function(t){"accepted"===C.default(t.data,"response")?e(!0):n(new Error("devices-module.device.transmit.failed"))})).catch((function(){n(new Error("devices-module.device.transmit.failed"))}))}))},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.DEVICES_CREATED_ENTITY,t.DevicesModule.DEVICES_UPDATED_ENTITY,t.DevicesModule.DEVICES_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!Je.compile(k)(c)){n.next=46;break}if(_e.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.DEVICES_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.DEVICES_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.devices.update.failed");case 10:if(r.routingKey!==t.DevicesModule.DEVICES_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:w.DELETING,id:c.id}),n.prev=12,n.next=15,_e.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.devices.delete.failed",n.t0,"Delete device failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:w.DELETING,id:c.id}),n.finish(20);case 23:n.next=43;break;case 25:if(r.routingKey!==t.DevicesModule.DEVICES_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_UPDATED_ENTITY?w.UPDATING:w.CREATING,id:c.id}),o={},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));o[t]=c[e]})),n.prev=30,n.next=33,_e.insertOrUpdate({data:o});case 33:n.next=40;break;case 35:return n.prev=35,n.t1=n.catch(30),n.next=39,_e.get(c.id,!1);case 39:throw new Ce("devices-module.devices.update.failed",n.t1,"Edit device failed.");case 40:return n.prev=40,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_UPDATED_ENTITY?w.UPDATING:w.CREATING,id:c.id}),n.finish(40);case 43:return n.abrupt("return",!0);case 46:return n.abrupt("return",!1);case 47:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,40,43]])})))()},reset:function(e){(0,e.commit)("RESET_STATE"),Ae.reset()}},mutations:(J(Pe={},"SET_FIRST_LOAD",(function(e,t){e.firstLoad=t})),J(Pe,"SET_SEMAPHORE",(function(e,t){switch(t.type){case w.FETCHING:e.semaphore.fetching.items=!0;break;case w.GETTING:e.semaphore.fetching.item.push(C.default(t,"id","notValid")),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case w.CREATING:e.semaphore.creating.push(C.default(t,"id","notValid")),e.semaphore.creating=P.default(e.semaphore.creating);break;case w.UPDATING:e.semaphore.updating.push(C.default(t,"id","notValid")),e.semaphore.updating=P.default(e.semaphore.updating);break;case w.DELETING:e.semaphore.deleting.push(C.default(t,"id","notValid")),e.semaphore.deleting=P.default(e.semaphore.deleting)}})),J(Pe,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case w.FETCHING:e.semaphore.fetching.items=!1;break;case w.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===C.default(t,"id","notValid")&&e.semaphore.fetching.item.splice(n,1)}));break;case w.CREATING:e.semaphore.creating.forEach((function(r,n){r===C.default(t,"id","notValid")&&e.semaphore.creating.splice(n,1)}));break;case w.UPDATING:e.semaphore.updating.forEach((function(r,n){r===C.default(t,"id","notValid")&&e.semaphore.updating.splice(n,1)}));break;case w.DELETING:e.semaphore.deleting.forEach((function(r,n){r===C.default(t,"id","notValid")&&e.semaphore.deleting.splice(n,1)}))}})),J(Pe,"RESET_STATE",(function(e){Object.assign(e,We)})),Pe)},Xe=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),et={dataTransformer:function(e){return Xe.deserialize(e.data)}},tt=new x.default,rt={semaphore:{fetching:{items:[],item:[]},creating:[],updating:[],deleting:[]}},nt={state:function(){return rt},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:se.GETTING,id:t.id}),r.prev=4,r.next=7,ve.api().get("".concat(ze,"/v1/devices/").concat(t.device.id,"/properties/").concat(t.id),et);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.device-properties.fetch.failed",r.t0,"Fetching device property failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:se.GETTING,id:t.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},fetch:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.items.includes(t.device.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:se.FETCHING,id:t.device.id}),r.prev=4,r.next=7,ve.api().get("".concat(ze,"/v1/devices/").concat(t.device.id,"/properties"),et);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.device-properties.fetch.failed",r.t0,"Fetching device properties failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:se.FETCHING,id:t.device.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.property.id)){r.next=3;break}throw new Error("devices-module.device-properties.update.inProgress");case 3:if(ve.query().where("id",t.property.id).exists()){r.next=5;break}throw new Error("devices-module.device-properties.update.failed");case 5:return i("SET_SEMAPHORE",{type:se.UPDATING,id:t.property.id}),r.prev=6,r.next=9,ve.update({where:t.property.id,data:t.data});case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:se.UPDATING,id:t.property.id}),new Ce("devices-module.device-properties.update.failed",r.t0,"Edit device property failed.");case 15:if(null!==(a=ve.find(t.property.id))){r.next=23;break}if(null===(c=_e.find(t.property.deviceId))){r.next=21;break}return r.next=21,ve.get(c,t.property.id);case 21:throw i("CLEAR_SEMAPHORE",{type:se.UPDATING,id:t.property.id}),new Error("devices-module.device-properties.update.failed");case 23:return r.prev=23,r.next=26,ve.api().patch("".concat(ze,"/v1/devices/").concat(a.deviceId,"/properties/").concat(a.id),Xe.serialize({stuff:a}),et);case 26:return r.abrupt("return",ve.find(t.property.id));case 29:if(r.prev=29,r.t1=r.catch(23),null===(o=_e.find(t.property.deviceId))){r.next=35;break}return r.next=35,ve.get(o,t.property.id);case 35:throw new Me("devices-module.device-properties.update.failed",r.t1,"Edit device property failed.");case 36:return r.prev=36,i("CLEAR_SEMAPHORE",{type:se.UPDATING,id:t.property.id}),r.finish(36);case 39:case"end":return r.stop()}}),r,null,[[6,11],[23,29,36,39]])})))()},transmitData:function(e,r){return q(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ve.query().where("id",r.property.id).exists()){e.next=2;break}throw new Error("devices-module.device-properties.transmit.failed");case 2:if(null!==(n=_e.find(r.property.deviceId))){e.next=5;break}throw new Error("devices-module.device-properties.transmit.failed");case 5:return i=r.property.value,e.prev=6,e.next=9,ve.update({where:r.property.id,data:{value:r.value}});case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(6),new Ce("devices-module.device-properties.transmit.failed",e.t0,"Edit device property failed.");case 14:return e.abrupt("return",new Promise((function(e,a){ve.wamp().call({routing_key:t.DevicesModule.DEVICES_PROPERTIES_DATA,origin:ve.$devicesModuleOrigin,data:{device:n.key,property:r.property.key,expected:r.value}}).then((function(t){"accepted"===C.default(t.data,"response")?e(!0):(ve.update({where:r.property.id,data:{value:i}}),a(new Error("devices-module.device-properties.transmit.failed")))})).catch((function(){ve.update({where:r.property.id,data:{value:i}}),a(new Error("devices-module.device-properties.transmit.failed"))}))})));case 15:case"end":return e.stop()}}),e,null,[[6,11]])})))()},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.DEVICES_PROPERTY_CREATED_ENTITY,t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY,t.DevicesModule.DEVICES_PROPERTY_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!tt.compile(H)(c)){n.next=48;break}if(ve.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.device-properties.update.failed");case 10:if(r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:se.DELETING,id:c.id}),n.prev=12,n.next=15,ve.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.device-properties.delete.failed",n.t0,"Delete device property failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:se.DELETING,id:c.id}),n.finish(20);case 23:n.next=45;break;case 25:if(r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY?se.UPDATING:se.CREATING,id:c.id}),o={type:ue.PROPERTY},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));if("device"===t){var r=_e.query().where("identifier",c[e]).first();null!==r&&(o.deviceId=r.id)}else o[t]=c[e]})),n.prev=30,n.next=33,ve.insertOrUpdate({data:o});case 33:n.next=42;break;case 35:if(n.prev=35,n.t1=n.catch(30),null===(s=ve.query().with("device").where("id",c.id).first())||null===s.device){n.next=41;break}return n.next=41,ve.get(s.device,c.id);case 41:throw new Ce("devices-module.device-properties.update.failed",n.t1,"Edit device property failed.");case 42:return n.prev=42,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY?se.UPDATING:se.CREATING,id:c.id}),n.finish(42);case 45:return n.abrupt("return",!0);case 48:return n.abrupt("return",!1);case 49:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,42,45]])})))()},reset:function(e){(0,e.commit)("RESET_STATE")}},mutations:(J(Ge={},"SET_SEMAPHORE",(function(e,t){switch(t.type){case se.FETCHING:e.semaphore.fetching.items.push(t.id),e.semaphore.fetching.items=P.default(e.semaphore.fetching.items);break;case se.GETTING:e.semaphore.fetching.item.push(t.id),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case se.CREATING:e.semaphore.creating.push(t.id),e.semaphore.creating=P.default(e.semaphore.creating);break;case se.UPDATING:e.semaphore.updating.push(t.id),e.semaphore.updating=P.default(e.semaphore.updating);break;case se.DELETING:e.semaphore.deleting.push(t.id),e.semaphore.deleting=P.default(e.semaphore.deleting)}})),J(Ge,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case se.FETCHING:e.semaphore.fetching.items.forEach((function(r,n){r===t.id&&e.semaphore.fetching.items.splice(n,1)}));break;case se.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===t.id&&e.semaphore.fetching.item.splice(n,1)}));break;case se.CREATING:e.semaphore.creating.forEach((function(r,n){r===t.id&&e.semaphore.creating.splice(n,1)}));break;case se.UPDATING:e.semaphore.updating.forEach((function(r,n){r===t.id&&e.semaphore.updating.splice(n,1)}));break;case se.DELETING:e.semaphore.deleting.forEach((function(r,n){r===t.id&&e.semaphore.deleting.splice(n,1)}))}})),J(Ge,"RESET_STATE",(function(e){Object.assign(e,rt)})),Ge)},it=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),at={dataTransformer:function(e){return it.deserialize(e.data)}},ct=new x.default,ot={semaphore:{fetching:{items:[],item:[]},creating:[],updating:[],deleting:[]}},st={state:function(){return ot},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:le.GETTING,id:t.id}),r.prev=4,r.next=7,we.api().get("".concat(ze,"/v1/devices/").concat(t.device.id,"/configuration/").concat(t.id),at);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.device-configuration.fetch.failed",r.t0,"Fetching device configuration failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:le.GETTING,id:t.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},fetch:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.items.includes(t.device.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:le.FETCHING,id:t.device.id}),r.prev=4,r.next=7,we.api().get("".concat(ze,"/v1/devices/").concat(t.device.id,"/configuration"),at);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.device-configuration.fetch.failed",r.t0,"Fetching device configuration failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:le.FETCHING,id:t.device.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.configuration.id)){r.next=3;break}throw new Error("devices-module.device-configuration.update.inProgress");case 3:if(we.query().where("id",t.configuration.id).exists()){r.next=5;break}throw new Error("devices-module.device-configuration.update.failed");case 5:return i("SET_SEMAPHORE",{type:le.UPDATING,id:t.configuration.id}),r.prev=6,r.next=9,we.update({where:t.configuration.id,data:t.data});case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:le.UPDATING,id:t.configuration.id}),new Ce("devices-module.device-configuration.update.failed",r.t0,"Edit device configuration failed.");case 15:if(null!==(a=we.find(t.configuration.id))){r.next=23;break}if(null===(c=_e.find(t.configuration.deviceId))){r.next=21;break}return r.next=21,we.get(c,t.configuration.id);case 21:throw i("CLEAR_SEMAPHORE",{type:le.UPDATING,id:t.configuration.id}),new Error("devices-module.device-configuration.update.failed");case 23:if(null!==(o=_e.find(t.configuration.deviceId))){r.next=26;break}throw new Error("devices-module.device-configuration.update.failed");case 26:return r.prev=26,r.next=29,we.api().patch("".concat(ze,"/v1/devices/").concat(o.id,"/configuration/").concat(a.id),it.serialize({stuff:a}),at);case 29:return r.abrupt("return",we.find(t.configuration.id));case 32:return r.prev=32,r.t1=r.catch(26),r.next=36,we.get(o,t.configuration.id);case 36:throw new Me("devices-module.device-configuration.update.failed",r.t1,"Edit device configuration failed.");case 37:return r.prev=37,i("CLEAR_SEMAPHORE",{type:le.UPDATING,id:t.configuration.id}),r.finish(37);case 40:case"end":return r.stop()}}),r,null,[[6,11],[26,32,37,40]])})))()},transmitData:function(e,r){return q(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(we.query().where("id",r.configuration.id).exists()){e.next=2;break}throw new Error("devices-module.device-configuration.transmit.failed");case 2:if(null!==(n=_e.find(r.configuration.deviceId))){e.next=5;break}throw new Error("devices-module.device-configuration.transmit.failed");case 5:return i=r.configuration.value,e.prev=6,e.next=9,we.update({where:r.configuration.id,data:{value:r.value}});case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(6),new Ce("devices-module.device-configuration.transmit.failed",e.t0,"Edit device configuration failed.");case 14:return e.abrupt("return",new Promise((function(e,a){we.wamp().call({routing_key:t.DevicesModule.DEVICES_CONFIGURATION_DATA,origin:we.$devicesModuleOrigin,data:{device:n.key,configuration:r.configuration.key,expected:r.value}}).then((function(t){"accepted"===C.default(t.data,"response")?e(!0):(we.update({where:r.configuration.id,data:{value:i}}),a(new Error("devices-module.device-configuration.transmit.failed")))})).catch((function(){we.update({where:r.configuration.id,data:{value:i}}),a(new Error("devices-module.device-configuration.transmit.failed"))}))})));case 15:case"end":return e.stop()}}),e,null,[[6,11]])})))()},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.DEVICES_CONFIGURATION_CREATED_ENTITY,t.DevicesModule.DEVICES_CONFIGURATION_UPDATED_ENTITY,t.DevicesModule.DEVICES_CONFIGURATION_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!ct.compile(L)(c)){n.next=48;break}if(we.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.DEVICES_CONFIGURATION_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.DEVICES_CONFIGURATION_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.device-configuration.update.failed");case 10:if(r.routingKey!==t.DevicesModule.DEVICES_CONFIGURATION_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:le.DELETING,id:c.id}),n.prev=12,n.next=15,we.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.device-configuration.delete.failed",n.t0,"Delete device configuration failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:le.DELETING,id:c.id}),n.finish(20);case 23:n.next=45;break;case 25:if(r.routingKey!==t.DevicesModule.DEVICES_CONFIGURATION_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_CONFIGURATION_UPDATED_ENTITY?le.UPDATING:le.CREATING,id:c.id}),o={type:pe.CONFIGURATION},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));if("device"===t){var r=_e.query().where("device",c[e]).first();null!==r&&(o.deviceId=r.id)}else o[t]=c[e]})),n.prev=30,n.next=33,we.insertOrUpdate({data:o});case 33:n.next=42;break;case 35:if(n.prev=35,n.t1=n.catch(30),null===(s=we.query().with("device").where("id",c.id).first())||null===s.device){n.next=41;break}return n.next=41,we.get(s.device,c.id);case 41:throw new Ce("devices-module.device-configuration.update.failed",n.t1,"Edit device configuration failed.");case 42:return n.prev=42,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_CONFIGURATION_UPDATED_ENTITY?le.UPDATING:le.CREATING,id:c.id}),n.finish(42);case 45:return n.abrupt("return",!0);case 48:return n.abrupt("return",!1);case 49:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,42,45]])})))()},reset:function(e){(0,e.commit)("RESET_STATE")}},mutations:(J(He={},"SET_SEMAPHORE",(function(e,t){switch(t.type){case le.FETCHING:e.semaphore.fetching.items.push(t.id),e.semaphore.fetching.items=P.default(e.semaphore.fetching.items);break;case le.GETTING:e.semaphore.fetching.item.push(t.id),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case le.CREATING:e.semaphore.creating.push(t.id),e.semaphore.creating=P.default(e.semaphore.creating);break;case le.UPDATING:e.semaphore.updating.push(t.id),e.semaphore.updating=P.default(e.semaphore.updating);break;case le.DELETING:e.semaphore.deleting.push(t.id),e.semaphore.deleting=P.default(e.semaphore.deleting)}})),J(He,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case le.FETCHING:e.semaphore.fetching.items.forEach((function(r,n){r===t.id&&e.semaphore.fetching.items.splice(n,1)}));break;case le.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===t.id&&e.semaphore.fetching.item.splice(n,1)}));break;case le.CREATING:e.semaphore.creating.forEach((function(r,n){r===t.id&&e.semaphore.creating.splice(n,1)}));break;case le.UPDATING:e.semaphore.updating.forEach((function(r,n){r===t.id&&e.semaphore.updating.splice(n,1)}));break;case le.DELETING:e.semaphore.deleting.forEach((function(r,n){r===t.id&&e.semaphore.deleting.splice(n,1)}))}})),J(He,"RESET_STATE",(function(e){Object.assign(e,ot)})),He)},ut=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),dt={dataTransformer:function(e){return ut.deserialize(e.data)}},lt=new x.default,pt={semaphore:{fetching:{item:[]},creating:[],updating:[],deleting:[]}},ft={state:function(){return pt},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.device.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:Re.GETTING,id:t.device.id}),r.prev=4,r.next=7,ke.api().get("".concat(ze,"/v1/devices/").concat(t.device.id,"/connector"),dt);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.device-connector.get.failed",r.t0,"Fetching device connector failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:Re.GETTING,id:t.device.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},add:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,i=void 0!==t.id&&null!==t.id&&""!==t.id?t.id:M.default.v4().toString(),a=void 0!==t.draft&&t.draft,n("SET_SEMAPHORE",{type:Re.CREATING,id:i}),r.prev=4,r.next=7,ke.insert({data:Object.assign({},t.data,{id:i,draft:a,deviceId:t.device.id,connectorId:t.connector.id})});case 7:r.next=13;break;case 9:throw r.prev=9,r.t0=r.catch(4),n("CLEAR_SEMAPHORE",{type:Re.CREATING,id:i}),new Ce("devices-module.device-connector.create.failed",r.t0,"Create device connector failed.");case 13:if(null!==(c=ke.find(i))){r.next=19;break}return r.next=17,ke.delete(i);case 17:throw n("CLEAR_SEMAPHORE",{type:Re.CREATING,id:i}),new Error("devices-module.device-connector.create.failed");case 19:if(!a){r.next=24;break}return n("CLEAR_SEMAPHORE",{type:Re.CREATING,id:i}),r.abrupt("return",ke.find(i));case 24:return r.prev=24,r.next=27,ke.api().post("".concat(ze,"/v1/devices/").concat(t.device.id,"/connector"),ut.serialize({stuff:c}),dt);case 27:return r.abrupt("return",ke.find(i));case 30:return r.prev=30,r.t1=r.catch(24),r.next=34,ke.delete(i);case 34:throw new Me("devices-module.device-connector.create.failed",r.t1,"Create device connector failed.");case 35:return r.prev=35,n("CLEAR_SEMAPHORE",{type:Re.CREATING,id:i}),r.finish(35);case 38:case"end":return r.stop()}}),r,null,[[4,9],[24,30,35,38]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.connector.id)){r.next=3;break}throw new Error("devices-module.device-connector.update.inProgress");case 3:if(ke.query().where("id",t.connector.id).exists()){r.next=5;break}throw new Error("devices-module.device-connector.update.failed");case 5:return i("SET_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),r.prev=6,r.next=9,ke.update({where:t.connector.id,data:t.data});case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),new Ce("devices-module.device-connector.update.failed",r.t0,"Edit device connector failed.");case 15:if(null!==(a=ke.find(t.connector.id))){r.next=23;break}if(null===(c=_e.find(t.connector.deviceId))){r.next=21;break}return r.next=21,ke.get(c);case 21:throw i("CLEAR_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),new Error("devices-module.device-connector.update.failed");case 23:if(!a.draft){r.next=28;break}return i("CLEAR_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),r.abrupt("return",ke.find(t.connector.id));case 28:return r.prev=28,r.next=31,ke.api().patch("".concat(ze,"/v1/devices/").concat(a.deviceId,"/connector"),ut.serialize({stuff:a}),dt);case 31:return r.abrupt("return",ke.find(t.connector.id));case 34:if(r.prev=34,r.t1=r.catch(28),null===(o=_e.find(t.connector.deviceId))){r.next=40;break}return r.next=40,ke.get(o);case 40:throw new Me("devices-module.device-connector.update.failed",r.t1,"Edit device connector failed.");case 41:return r.prev=41,i("CLEAR_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),r.finish(41);case 44:case"end":return r.stop()}}),r,null,[[6,11],[28,34,41,44]])})))()},save:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.connector.id)){r.next=3;break}throw new Error("devices-module.device-connector.save.inProgress");case 3:if(ke.query().where("id",t.connector.id).where("draft",!0).exists()){r.next=5;break}throw new Error("devices-module.device-connector.save.failed");case 5:if(i("SET_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),null!==(a=ke.find(t.connector.id))){r.next=10;break}throw i("CLEAR_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),new Error("devices-module.device-connector.save.failed");case 10:return r.prev=10,r.next=13,ke.api().post("".concat(ze,"/v1/devices/").concat(a.deviceId,"/connector"),ut.serialize({stuff:a}),dt);case 13:return r.abrupt("return",ke.find(t.connector.id));case 16:throw r.prev=16,r.t0=r.catch(10),new Me("devices-module.device-connector.save.failed",r.t0,"Save draft device connector failed.");case 19:return r.prev=19,i("CLEAR_SEMAPHORE",{type:Re.UPDATING,id:t.connector.id}),r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[10,16,19,22]])})))()},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.DEVICES_CONNECTOR_CREATED_ENTITY,t.DevicesModule.DEVICES_CONNECTOR_UPDATED_ENTITY,t.DevicesModule.DEVICES_CONNECTOR_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!lt.compile(U)(c)){n.next=48;break}if(ke.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.device-connector.update.failed");case 10:if(r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:Re.DELETING,id:c.id}),n.prev=12,n.next=15,ke.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.device-connector.delete.failed",n.t0,"Delete device connector failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:Re.DELETING,id:c.id}),n.finish(20);case 23:n.next=45;break;case 25:if(r.routingKey!==t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY?Re.UPDATING:Re.CREATING,id:c.id}),o={type:be.CONNECTOR},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));if("device"===t){var r=_e.query().where("identifier",c[e]).first();null!==r&&(o.deviceId=r.id)}else o[t]=c[e]})),n.prev=30,n.next=33,ke.insertOrUpdate({data:o});case 33:n.next=42;break;case 35:if(n.prev=35,n.t1=n.catch(30),null===(s=ke.query().with("device").where("id",c.id).first())||null===s.device){n.next=41;break}return n.next=41,ke.get(s.device);case 41:throw new Ce("devices-module.device-connector.update.failed",n.t1,"Edit device connector failed.");case 42:return n.prev=42,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.DEVICES_PROPERTY_UPDATED_ENTITY?Re.UPDATING:Re.CREATING,id:c.id}),n.finish(42);case 45:return n.abrupt("return",!0);case 48:return n.abrupt("return",!1);case 49:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,42,45]])})))()},reset:function(e){(0,e.commit)("RESET_STATE")}},mutations:(J(Le={},"SET_SEMAPHORE",(function(e,t){switch(t.type){case Re.GETTING:e.semaphore.fetching.item.push(t.id),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case Re.CREATING:e.semaphore.creating.push(t.id),e.semaphore.creating=P.default(e.semaphore.creating);break;case Re.UPDATING:e.semaphore.updating.push(t.id),e.semaphore.updating=P.default(e.semaphore.updating);break;case Re.DELETING:e.semaphore.deleting.push(t.id),e.semaphore.deleting=P.default(e.semaphore.deleting)}})),J(Le,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case Re.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===t.id&&e.semaphore.fetching.item.splice(n,1)}));break;case Re.CREATING:e.semaphore.creating.forEach((function(r,n){r===t.id&&e.semaphore.creating.splice(n,1)}));break;case Re.UPDATING:e.semaphore.updating.forEach((function(r,n){r===t.id&&e.semaphore.updating.splice(n,1)}));break;case Re.DELETING:e.semaphore.deleting.forEach((function(r,n){r===t.id&&e.semaphore.deleting.splice(n,1)}))}})),J(Le,"RESET_STATE",(function(e){Object.assign(e,pt)})),Le)},ht=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),vt={dataTransformer:function(e){return ht.deserialize(e.data)}},Et=new x.default,mt={semaphore:{fetching:{items:[],item:[]},creating:[],updating:[],deleting:[]},firstLoad:[]},gt={state:function(){return mt},getters:{firstLoadFinished:function(e){return function(t){return e.firstLoad.includes(t)}},getting:function(e){return function(t){return e.semaphore.fetching.item.includes(t)}},fetching:function(e){return function(t){return null!==t?e.semaphore.fetching.items.includes(t):e.semaphore.fetching.items.length>0}}},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:Ee.GETTING,id:t.id}),r.prev=4,r.next=7,Ae.api().get("".concat(ze,"/v1/devices/").concat(t.device.id,"/channels/").concat(t.id,"?include=properties,configuration"),vt);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.channels.get.failed",r.t0,"Fetching channel failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:Ee.GETTING,id:t.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},fetch:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.items.includes(t.device.id)&&!t.device.draft){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:Ee.FETCHING,id:t.device.id}),r.prev=4,r.next=7,Ae.api().get("".concat(ze,"/v1/devices/").concat(t.device.id,"/channels?include=properties,configuration"),vt);case 7:return i("SET_FIRST_LOAD",{id:t.device.id}),r.abrupt("return",!0);case 11:throw r.prev=11,r.t0=r.catch(4),new Me("devices-module.channels.fetch.failed",r.t0,"Fetching channels failed.");case 14:return r.prev=14,i("CLEAR_SEMAPHORE",{type:Ee.FETCHING,id:t.device.id}),r.finish(14);case 17:case"end":return r.stop()}}),r,null,[[4,11,14,17]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.channel.id)){r.next=3;break}throw new Error("devices-module.channels.update.inProgress");case 3:if(Ae.query().where("id",t.channel.id).exists()){r.next=5;break}throw new Error("devices-module.channels.update.failed");case 5:return i("SET_SEMAPHORE",{type:Ee.UPDATING,id:t.channel.id}),r.prev=6,r.next=9,Ae.update({where:t.channel.id,data:t.data});case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:Ee.UPDATING,id:t.channel.id}),new Ce("devices-module.channels.edit.failed",r.t0,"Edit channel failed.");case 15:if(null!==(a=Ae.find(t.channel.id))){r.next=23;break}if(null===(c=_e.find(t.channel.deviceId))){r.next=21;break}return r.next=21,Ae.get(c,t.channel.id);case 21:throw i("CLEAR_SEMAPHORE",{type:Ee.UPDATING,id:t.channel.id}),new Error("devices-module.channels.update.failed");case 23:return r.prev=23,r.next=26,Ae.api().patch("".concat(ze,"/v1/devices/").concat(a.deviceId,"/channels/").concat(a.id,"?include=properties,configuration"),ht.serialize({stuff:a}),vt);case 26:return r.abrupt("return",Ae.find(t.channel.id));case 29:if(r.prev=29,r.t1=r.catch(23),null===(o=_e.find(t.channel.deviceId))){r.next=35;break}return r.next=35,Ae.get(o,t.channel.id);case 35:throw new Me("devices-module.channels.update.failed",r.t1,"Edit channel failed.");case 36:return r.prev=36,i("CLEAR_SEMAPHORE",{type:Ee.UPDATING,id:t.channel.id}),r.finish(36);case 39:case"end":return r.stop()}}),r,null,[[6,11],[23,29,36,39]])})))()},transmitCommand:function(e,r){if(!Ae.query().where("id",r.channel.id).exists())throw new Error("devices-module.channel.transmit.failed");var n=_e.find(r.channel.deviceId);if(null===n)throw new Error("devices-module.channel.transmit.failed");return new Promise((function(e,i){Ae.wamp().call({routing_key:t.DevicesModule.CHANNELS_CONTROLS,origin:Ae.$devicesModuleOrigin,data:{control:r.command,device:n.key,channel:r.channel.key}}).then((function(t){"accepted"===C.default(t.data,"response")?e(!0):i(new Error("devices-module.channel.transmit.failed"))})).catch((function(){i(new Error("devices-module.channel.transmit.failed"))}))}))},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.CHANNELS_CREATED_ENTITY,t.DevicesModule.CHANNELS_UPDATED_ENTITY,t.DevicesModule.CHANNELS_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!Et.compile(F)(c)){n.next=48;break}if(Ae.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.CHANNELS_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.CHANNELS_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.channels.update.failed");case 10:if(r.routingKey!==t.DevicesModule.CHANNELS_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:Ee.DELETING,id:c.id}),n.prev=12,n.next=15,Ae.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.channels.delete.failed",n.t0,"Delete channel failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:Ee.DELETING,id:c.id}),n.finish(20);case 23:n.next=45;break;case 25:if(r.routingKey!==t.DevicesModule.CHANNELS_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CHANNELS_UPDATED_ENTITY?Ee.UPDATING:Ee.CREATING,id:c.id}),o={type:me.CHANNEL},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));if("device"===t){var r=_e.query().where("identifier",c[e]).first();null!==r&&(o.deviceId=r.id)}else o[t]=c[e]})),n.prev=30,n.next=33,Ae.insertOrUpdate({data:o});case 33:n.next=42;break;case 35:if(n.prev=35,n.t1=n.catch(30),null===(s=Ae.query().with("device").where("id",c.id).first())||null===s.device){n.next=41;break}return n.next=41,Ae.get(s.device,c.id);case 41:throw new Ce("devices-module.channels.update.failed",n.t1,"Edit channel failed.");case 42:return n.prev=42,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CHANNELS_UPDATED_ENTITY?Ee.UPDATING:Ee.CREATING,id:c.id}),n.finish(42);case 45:return n.abrupt("return",!0);case 48:return n.abrupt("return",!1);case 49:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,42,45]])})))()},reset:function(e){(0,e.commit)("RESET_STATE")}},mutations:(J(Ue={},"SET_FIRST_LOAD",(function(e,t){e.firstLoad.push(t.id),e.firstLoad=P.default(e.firstLoad)})),J(Ue,"SET_SEMAPHORE",(function(e,t){switch(t.type){case Ee.FETCHING:e.semaphore.fetching.items.push(t.id),e.semaphore.fetching.items=P.default(e.semaphore.fetching.items);break;case Ee.GETTING:e.semaphore.fetching.item.push(t.id),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case Ee.CREATING:e.semaphore.creating.push(t.id),e.semaphore.creating=P.default(e.semaphore.creating);break;case Ee.UPDATING:e.semaphore.updating.push(t.id),e.semaphore.updating=P.default(e.semaphore.updating);break;case Ee.DELETING:e.semaphore.deleting.push(t.id),e.semaphore.deleting=P.default(e.semaphore.deleting)}})),J(Ue,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case Ee.FETCHING:e.semaphore.fetching.items.forEach((function(r,n){r===t.id&&e.semaphore.fetching.items.splice(n,1)}));break;case Ee.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===t.id&&e.semaphore.fetching.item.splice(n,1)}));break;case Ee.CREATING:e.semaphore.creating.forEach((function(r,n){r===t.id&&e.semaphore.creating.splice(n,1)}));break;case Ee.UPDATING:e.semaphore.updating.forEach((function(r,n){r===t.id&&e.semaphore.updating.splice(n,1)}));break;case Ee.DELETING:e.semaphore.deleting.forEach((function(r,n){r===t.id&&e.semaphore.deleting.splice(n,1)}))}})),J(Ue,"RESET_STATE",(function(e){Object.assign(e,mt)})),Ue)},Tt=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),yt={dataTransformer:function(e){return Tt.deserialize(e.data)}},wt=new x.default,Rt={semaphore:{fetching:{items:[],item:[]},creating:[],updating:[],deleting:[]}},bt={state:function(){return Rt},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:ge.GETTING,id:t.id}),r.prev=4,r.next=7,Ne.api().get("".concat(ze,"/v1/devices/").concat(t.channel.deviceId,"/channels/").concat(t.channel.id,"/properties/").concat(t.id),yt);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.channel-properties.fetch.failed",r.t0,"Fetching channel property failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:ge.GETTING,id:t.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},fetch:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.items.includes(t.channel.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:ge.FETCHING,id:t.channel.id}),r.prev=4,r.next=7,Ne.api().get("".concat(ze,"/v1/devices/").concat(t.channel.deviceId,"/channels/").concat(t.channel.id,"/properties"),yt);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.channel-properties.fetch.failed",r.t0,"Fetching channel properties failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:ge.FETCHING,id:t.channel.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.property.id)){r.next=3;break}throw new Error("devices-module.channel-properties.update.inProgress");case 3:if(Ne.query().where("id",t.property.id).exists()){r.next=5;break}throw new Error("devices-module.channel-properties.update.failed");case 5:return i("SET_SEMAPHORE",{type:ge.UPDATING,id:t.property.id}),r.prev=6,r.next=9,Ne.update({where:t.property.id,data:t.data});case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:ge.UPDATING,id:t.property.id}),new Ce("devices-module.channel-properties.update.failed",r.t0,"Edit channel property failed.");case 15:if(null!==(a=Ne.find(t.property.id))){r.next=23;break}if(null===(c=Ae.find(t.property.channelId))){r.next=21;break}return r.next=21,Ne.get(c,t.property.id);case 21:throw i("CLEAR_SEMAPHORE",{type:ge.UPDATING,id:t.property.id}),new Error("devices-module.channel-properties.update.failed");case 23:if(null!==(o=Ae.find(t.property.channelId))){r.next=26;break}throw new Error("devices-module.channel-properties.update.failed");case 26:return r.prev=26,r.next=29,Ne.api().patch("".concat(ze,"/v1/devices/").concat(o.deviceId,"/channels/").concat(a.channelId,"/properties/").concat(a.id),Tt.serialize({stuff:a}),yt);case 29:return r.abrupt("return",Ne.find(t.property.id));case 32:return r.prev=32,r.t1=r.catch(26),r.next=36,Ne.get(o,t.property.id);case 36:throw new Me("devices-module.channel-properties.update.failed",r.t1,"Edit channel property failed.");case 37:return r.prev=37,i("CLEAR_SEMAPHORE",{type:ge.UPDATING,id:t.property.id}),r.finish(37);case 40:case"end":return r.stop()}}),r,null,[[6,11],[26,32,37,40]])})))()},transmitData:function(e,r){return q(regeneratorRuntime.mark((function e(){var n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ne.query().where("id",r.property.id).exists()){e.next=2;break}throw new Error("devices-module.channel-properties.transmit.failed");case 2:if(null!==(n=Ae.find(r.property.channelId))){e.next=5;break}throw new Error("devices-module.channel-properties.transmit.failed");case 5:if(null!==(i=_e.find(n.deviceId))){e.next=8;break}throw new Error("devices-module.channel-properties.transmit.failed");case 8:return a=r.property.value,e.prev=9,e.next=12,Ne.update({where:r.property.id,data:{value:r.value}});case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(9),new Ce("devices-module.channel-properties.transmit.failed",e.t0,"Edit channel property failed.");case 17:return e.abrupt("return",new Promise((function(e,c){Ne.wamp().call({routing_key:t.DevicesModule.CHANNELS_PROPERTIES_DATA,origin:Ne.$devicesModuleOrigin,data:{device:i.key,channel:n.key,property:r.property.key,expected:r.value}}).then((function(t){"accepted"===C.default(t.data,"response")?e(!0):(Ne.update({where:r.property.id,data:{value:a}}),c(new Error("devices-module.channel-properties.transmit.failed")))})).catch((function(){Ne.update({where:r.property.id,data:{value:a}}),c(new Error("devices-module.channel-properties.transmit.failed"))}))})));case 18:case"end":return e.stop()}}),e,null,[[9,14]])})))()},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.CHANNELS_PROPERTY_CREATED_ENTITY,t.DevicesModule.CHANNELS_PROPERTY_UPDATED_ENTITY,t.DevicesModule.CHANNELS_PROPERTY_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!wt.compile(Y)(c)){n.next=48;break}if(Ne.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.CHANNELS_PROPERTY_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.CHANNELS_PROPERTY_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.channel-properties.update.failed");case 10:if(r.routingKey!==t.DevicesModule.CHANNELS_PROPERTY_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:ge.DELETING,id:c.id}),n.prev=12,n.next=15,Ne.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.channel-properties.delete.failed",n.t0,"Delete channel property failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:ge.DELETING,id:c.id}),n.finish(20);case 23:n.next=45;break;case 25:if(r.routingKey!==t.DevicesModule.CHANNELS_PROPERTY_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CHANNELS_PROPERTY_UPDATED_ENTITY?ge.UPDATING:ge.CREATING,id:c.id}),o={type:Te.PROPERTY},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));if("channel"===t){var r=Ae.query().where("channel",c[e]).first();null!==r&&(o.channelId=r.id)}else o[t]=c[e]})),n.prev=30,n.next=33,Ne.insertOrUpdate({data:o});case 33:n.next=42;break;case 35:if(n.prev=35,n.t1=n.catch(30),null===(s=Ne.query().with("channel").where("id",c.id).first())||null===s.channel){n.next=41;break}return n.next=41,Ne.get(s.channel,c.id);case 41:throw new Ce("devices-module.channel-properties.update.failed",n.t1,"Edit channel property failed.");case 42:return n.prev=42,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CHANNELS_PROPERTY_UPDATED_ENTITY?ge.UPDATING:ge.CREATING,id:c.id}),n.finish(42);case 45:return n.abrupt("return",!0);case 48:return n.abrupt("return",!1);case 49:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,42,45]])})))()},reset:function(e){(0,e.commit)("RESET_STATE")}},mutations:(J(Fe={},"SET_SEMAPHORE",(function(e,t){switch(t.type){case ge.FETCHING:e.semaphore.fetching.items.push(t.id),e.semaphore.fetching.items=P.default(e.semaphore.fetching.items);break;case ge.GETTING:e.semaphore.fetching.item.push(t.id),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case ge.CREATING:e.semaphore.creating.push(t.id),e.semaphore.creating=P.default(e.semaphore.creating);break;case ge.UPDATING:e.semaphore.updating.push(t.id),e.semaphore.updating=P.default(e.semaphore.updating);break;case ge.DELETING:e.semaphore.deleting.push(t.id),e.semaphore.deleting=P.default(e.semaphore.deleting)}})),J(Fe,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case ge.FETCHING:e.semaphore.fetching.items.forEach((function(r,n){r===t.id&&e.semaphore.fetching.items.splice(n,1)}));break;case ge.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===t.id&&e.semaphore.fetching.item.splice(n,1)}));break;case ge.CREATING:e.semaphore.creating.forEach((function(r,n){r===t.id&&e.semaphore.creating.splice(n,1)}));break;case ge.UPDATING:e.semaphore.updating.forEach((function(r,n){r===t.id&&e.semaphore.updating.splice(n,1)}));break;case ge.DELETING:e.semaphore.deleting.forEach((function(r,n){r===t.id&&e.semaphore.deleting.splice(n,1)}))}})),J(Fe,"RESET_STATE",(function(e){Object.assign(e,Rt)})),Fe)},Nt=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),It={dataTransformer:function(e){return Nt.deserialize(e.data)}},At=new x.default,St={semaphore:{fetching:{items:[],item:[]},creating:[],updating:[],deleting:[]}},Dt={state:function(){return St},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:Se.GETTING,id:t.id}),r.prev=4,r.next=7,Ie.api().get("".concat(ze,"/v1/devices/").concat(t.channel.deviceId,"/channels/").concat(t.channel.id,"/configuration/").concat(t.id),It);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.channel-configuration.fetch.failed",r.t0,"Fetching channel configuration failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:Se.GETTING,id:t.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},fetch:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.items.includes(t.channel.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:Se.FETCHING,id:t.channel.id}),r.prev=4,r.next=7,Ie.api().get("".concat(ze,"/v1/devices/").concat(t.channel.deviceId,"/channels/").concat(t.channel.id,"/configuration"),It);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.channel-configuration.fetch.failed",r.t0,"Fetching channel configuration failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:Se.FETCHING,id:t.channel.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a,c,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.configuration.id)){r.next=3;break}throw new Error("devices-module.channel-configuration.update.inProgress");case 3:if(Ie.query().where("id",t.configuration.id).exists()){r.next=5;break}throw new Error("devices-module.channel-configuration.update.failed");case 5:return i("SET_SEMAPHORE",{type:Se.UPDATING,id:t.configuration.id}),r.prev=6,r.next=9,Ie.update({where:t.configuration.id,data:t.data});case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:Se.UPDATING,id:t.configuration.id}),new Ce("devices-module.channel-configuration.update.failed",r.t0,"Edit channel configuration failed.");case 15:if(null!==(a=Ie.find(t.configuration.id))){r.next=23;break}if(null===(c=Ae.find(t.configuration.channelId))){r.next=21;break}return r.next=21,Ie.get(c,t.configuration.id);case 21:throw i("CLEAR_SEMAPHORE",{type:Se.UPDATING,id:t.configuration.id}),new Error("devices-module.channel-configuration.update.failed");case 23:if(null!==(o=Ae.find(t.configuration.channelId))){r.next=26;break}throw new Error("devices-module.channel-configuration.update.failed");case 26:return r.prev=26,r.next=29,Ie.api().patch("".concat(ze,"/v1/devices/").concat(o.deviceId,"/channels/").concat(a.channelId,"/configuration/").concat(a.id),Nt.serialize({stuff:a}),It);case 29:return r.abrupt("return",Ie.find(t.configuration.id));case 32:return r.prev=32,r.t1=r.catch(26),r.next=36,Ie.get(o,t.configuration.id);case 36:throw new Me("devices-module.channel-configuration.update.failed",r.t1,"Edit channel configuration failed.");case 37:return r.prev=37,i("CLEAR_SEMAPHORE",{type:Se.UPDATING,id:t.configuration.id}),r.finish(37);case 40:case"end":return r.stop()}}),r,null,[[6,11],[26,32,37,40]])})))()},transmitData:function(e,r){return q(regeneratorRuntime.mark((function e(){var n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ie.query().where("id",r.configuration.id).exists()){e.next=2;break}throw new Error("devices-module.channel-configuration.transmit.failed");case 2:if(null!==(n=Ae.find(r.configuration.channelId))){e.next=5;break}throw new Error("devices-module.channel-configuration.transmit.failed");case 5:if(null!==(i=_e.find(n.deviceId))){e.next=8;break}throw new Error("devices-module.channel-configuration.transmit.failed");case 8:return a=r.configuration.value,e.prev=9,e.next=12,Ie.update({where:r.configuration.id,data:{value:r.value}});case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(9),new Ce("devices-module.channel-configuration.transmit.failed",e.t0,"Edit channel configuration failed.");case 17:return e.abrupt("return",new Promise((function(e,c){Ie.wamp().call({routing_key:t.DevicesModule.CHANNELS_CONFIGURATION_DATA,origin:Ie.$devicesModuleOrigin,data:{device:i.key,channel:n.key,configuration:r.configuration.key,expected:r.value}}).then((function(t){"accepted"===C.default(t.data,"response")?e(!0):(Ie.update({where:r.configuration.id,data:{value:a}}),c(new Error("devices-module.channel-configuration.transmit.failed")))})).catch((function(){Ie.update({where:r.configuration.id,data:{value:a}}),c(new Error("devices-module.channel-configuration.transmit.failed"))}))})));case 18:case"end":return e.stop()}}),e,null,[[9,14]])})))()},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.CHANNELS_CONFIGURATION_CREATED_ENTITY,t.DevicesModule.CHANNELS_CONFIGURATION_UPDATED_ENTITY,t.DevicesModule.CHANNELS_CONFIGURATION_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!At.compile(j)(c)){n.next=48;break}if(Ie.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.CHANNELS_CONFIGURATION_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.CHANNELS_CONFIGURATION_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.channel-configuration.update.failed");case 10:if(r.routingKey!==t.DevicesModule.CHANNELS_CONFIGURATION_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:Se.DELETING,id:c.id}),n.prev=12,n.next=15,Ie.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.channel-configuration.delete.failed",n.t0,"Delete channel configuration failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:Se.DELETING,id:c.id}),n.finish(20);case 23:n.next=45;break;case 25:if(r.routingKey!==t.DevicesModule.CHANNELS_CONFIGURATION_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CHANNELS_CONFIGURATION_UPDATED_ENTITY?Se.UPDATING:Se.CREATING,id:c.id}),o={type:De.CONFIGURATION},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));if("channel"===t){var r=Ae.query().where("channel",c[e]).first();null!==r&&(o.channelId=r.id)}else o[t]=c[e]})),n.prev=30,n.next=33,Ie.insertOrUpdate({data:o});case 33:n.next=42;break;case 35:if(n.prev=35,n.t1=n.catch(30),null===(s=Ie.query().with("channel").where("id",c.id).first())||null===s.channel){n.next=41;break}return n.next=41,Ie.get(s.channel,c.id);case 41:throw new Ce("devices-module.channel-configuration.update.failed",n.t1,"Edit channel configuration failed.");case 42:return n.prev=42,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CHANNELS_CONFIGURATION_UPDATED_ENTITY?Se.UPDATING:Se.CREATING,id:c.id}),n.finish(42);case 45:return n.abrupt("return",!0);case 48:return n.abrupt("return",!1);case 49:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,42,45]])})))()},reset:function(e){(0,e.commit)("RESET_STATE")}},mutations:(J(Ye={},"SET_SEMAPHORE",(function(e,t){switch(t.type){case Se.FETCHING:e.semaphore.fetching.items.push(t.id),e.semaphore.fetching.items=P.default(e.semaphore.fetching.items);break;case Se.GETTING:e.semaphore.fetching.item.push(t.id),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case Se.CREATING:e.semaphore.creating.push(t.id),e.semaphore.creating=P.default(e.semaphore.creating);break;case Se.UPDATING:e.semaphore.updating.push(t.id),e.semaphore.updating=P.default(e.semaphore.updating);break;case Se.DELETING:e.semaphore.deleting.push(t.id),e.semaphore.deleting=P.default(e.semaphore.deleting)}})),J(Ye,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case Se.FETCHING:e.semaphore.fetching.items.forEach((function(r,n){r===t.id&&e.semaphore.fetching.items.splice(n,1)}));break;case Se.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===t.id&&e.semaphore.fetching.item.splice(n,1)}));break;case Se.CREATING:e.semaphore.creating.forEach((function(r,n){r===t.id&&e.semaphore.creating.splice(n,1)}));break;case Se.UPDATING:e.semaphore.updating.forEach((function(r,n){r===t.id&&e.semaphore.updating.splice(n,1)}));break;case Se.DELETING:e.semaphore.deleting.forEach((function(r,n){r===t.id&&e.semaphore.deleting.splice(n,1)}))}})),J(Ye,"RESET_STATE",(function(e){Object.assign(e,St)})),Ye)};!function(e){e.FETCHING="fetching",e.GETTING="getting",e.CREATING="creating",e.UPDATING="updating",e.DELETING="deleting"}(je||(je={})),function(e){e.FB_BUS="devices-module/connector-fb-bus",e.FB_MQTT_V1="devices-module/connector-fb-mqtt-v1"}($e||($e={}));var Ot=new _.default({modelPropertiesMapper:new Ke,jsonPropertiesMapper:new qe}),kt={dataTransformer:function(e){return Ot.deserialize(e.data)}},_t=new x.default,xt={semaphore:{fetching:{items:!1,item:[]},updating:[]},firstLoad:!1},Mt={state:function(){return xt},getters:{firstLoadFinished:function(e){return function(){return!!e.firstLoad}},getting:function(e){return function(t){return e.semaphore.fetching.item.includes(t)}},fetching:function(e){return function(){return e.semaphore.fetching.items}}},actions:{get:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.fetching.item.includes(t.id)){r.next=3;break}return r.abrupt("return",!1);case 3:return i("SET_SEMAPHORE",{type:je.GETTING,id:t.id}),r.prev=4,r.next=7,Oe.api().get("".concat(ze,"/v1/connectors/").concat(t.id),kt);case 7:return r.abrupt("return",!0);case 10:throw r.prev=10,r.t0=r.catch(4),new Me("devices-module.connectors.fetch.failed",r.t0,"Fetching connectors failed.");case 13:return r.prev=13,i("CLEAR_SEMAPHORE",{type:je.GETTING,id:t.id}),r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[4,10,13,16]])})))()},fetch:function(e){return q(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.state,n=e.commit,!r.semaphore.fetching.items){t.next=3;break}return t.abrupt("return",!1);case 3:return n("SET_SEMAPHORE",{type:je.FETCHING}),t.prev=4,t.next=7,Oe.api().get("".concat(ze,"/v1/connectors"),kt);case 7:return n("SET_FIRST_LOAD",!0),t.abrupt("return",!0);case 11:throw t.prev=11,t.t0=t.catch(4),new Me("devices-module.connectors.fetch.failed",t.t0,"Fetching connectors failed.");case 14:return t.prev=14,n("CLEAR_SEMAPHORE",{type:je.FETCHING}),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[4,11,14,17]])})))()},edit:function(e,t){return q(regeneratorRuntime.mark((function r(){var n,i,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.state,i=e.commit,!n.semaphore.updating.includes(t.connector.id)){r.next=3;break}throw new Error("devices-module.connectors.update.inProgress");case 3:if(Oe.query().where("id",t.connector.id).exists()){r.next=5;break}throw new Error("devices-module.connectors.update.failed");case 5:return i("SET_SEMAPHORE",{type:je.UPDATING,id:t.connector.id}),r.prev=6,r.next=9,Oe.update({where:t.connector.id,data:t.data});case 9:r.next=15;break;case 11:throw r.prev=11,r.t0=r.catch(6),i("CLEAR_SEMAPHORE",{type:je.UPDATING,id:t.connector.id}),new Ce("devices-module.connectors.update.failed",r.t0,"Edit connector failed.");case 15:if(null!==(a=Oe.find(t.connector.id))){r.next=21;break}return r.next=19,Oe.get(t.connector.id);case 19:throw i("CLEAR_SEMAPHORE",{type:je.UPDATING,id:t.connector.id}),new Error("devices-module.connectors.update.failed");case 21:return r.prev=21,r.next=24,Oe.api().patch("".concat(ze,"/v1/connectors/").concat(a.id),Ot.serialize({stuff:a}),kt);case 24:return r.abrupt("return",Oe.find(t.connector.id));case 27:return r.prev=27,r.t1=r.catch(21),r.next=31,Oe.get(t.connector.id);case 31:throw new Me("devices-module.connectors.update.failed",r.t1,"Edit connector failed.");case 32:return r.prev=32,i("CLEAR_SEMAPHORE",{type:je.UPDATING,id:t.connector.id}),r.finish(32);case 35:case"end":return r.stop()}}),r,null,[[6,11],[21,27,32,35]])})))()},transmitCommand:function(e,r){if(!Oe.query().where("id",r.connector.id).exists())throw new Error("devices-module.connector.transmit.failed");return new Promise((function(e,n){Oe.wamp().call({routing_key:t.DevicesModule.CONNECTOR_CONTROLS,origin:Oe.$devicesModuleOrigin,data:{control:r.command,connector:r.connector.id}}).then((function(t){"accepted"===C.default(t.data,"response")?e(!0):n(new Error("devices-module.connector.transmit.failed"))})).catch((function(){n(new Error("devices-module.connector.transmit.failed"))}))}))},socketData:function(e,r){return q(regeneratorRuntime.mark((function n(){var i,a,c,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.state,a=e.commit,r.origin===t.ModuleOrigin.MODULE_DEVICES_ORIGIN){n.next=3;break}return n.abrupt("return",!1);case 3:if([t.DevicesModule.CONNECTOR_CREATED_ENTITY,t.DevicesModule.CONNECTOR_UPDATED_ENTITY,t.DevicesModule.CONNECTOR_DELETED_ENTITY].includes(r.routingKey)){n.next=5;break}return n.abrupt("return",!1);case 5:if(c=JSON.parse(r.data),!_t.compile($)(c)){n.next=46;break}if(Oe.query().where("id",c.id).exists()||r.routingKey!==t.DevicesModule.CONNECTOR_UPDATED_ENTITY&&r.routingKey!==t.DevicesModule.CONNECTOR_DELETED_ENTITY){n.next=10;break}throw new Error("devices-module.connectors.update.failed");case 10:if(r.routingKey!==t.DevicesModule.CONNECTOR_DELETED_ENTITY){n.next=25;break}return a("SET_SEMAPHORE",{type:je.DELETING,id:c.id}),n.prev=12,n.next=15,Oe.delete(c.id);case 15:n.next=20;break;case 17:throw n.prev=17,n.t0=n.catch(12),new Ce("devices-module.connectors.delete.failed",n.t0,"Delete connector failed.");case 20:return n.prev=20,a("CLEAR_SEMAPHORE",{type:je.DELETING,id:c.id}),n.finish(20);case 23:n.next=43;break;case 25:if(r.routingKey!==t.DevicesModule.CONNECTOR_UPDATED_ENTITY||!i.semaphore.updating.includes(c.id)){n.next=27;break}return n.abrupt("return",!0);case 27:return a("SET_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CONNECTOR_UPDATED_ENTITY?je.UPDATING:je.CREATING,id:c.id}),o={},Object.keys(c).forEach((function(e){var t=e.replace(/([a-z][A-Z0-9])/g,(function(e){return"".concat(e[0],"_").concat(e[1].toLowerCase())}));o[t]=c[e]})),n.prev=30,n.next=33,Oe.insertOrUpdate({data:o});case 33:n.next=40;break;case 35:return n.prev=35,n.t1=n.catch(30),n.next=39,Oe.get(c.id);case 39:throw new Ce("devices-module.connectors.update.failed",n.t1,"Edit connector failed.");case 40:return n.prev=40,a("CLEAR_SEMAPHORE",{type:r.routingKey===t.DevicesModule.CONNECTOR_UPDATED_ENTITY?je.UPDATING:je.CREATING,id:c.id}),n.finish(40);case 43:return n.abrupt("return",!0);case 46:return n.abrupt("return",!1);case 47:case"end":return n.stop()}}),n,null,[[12,17,20,23],[30,35,40,43]])})))()},reset:function(e){(0,e.commit)("RESET_STATE")}},mutations:(J(Ve={},"SET_FIRST_LOAD",(function(e,t){e.firstLoad=t})),J(Ve,"SET_SEMAPHORE",(function(e,t){switch(t.type){case je.FETCHING:e.semaphore.fetching.items=!0;break;case je.GETTING:e.semaphore.fetching.item.push(C.default(t,"id","notValid")),e.semaphore.fetching.item=P.default(e.semaphore.fetching.item);break;case je.UPDATING:e.semaphore.updating.push(C.default(t,"id","notValid")),e.semaphore.updating=P.default(e.semaphore.updating)}})),J(Ve,"CLEAR_SEMAPHORE",(function(e,t){switch(t.type){case je.FETCHING:e.semaphore.fetching.items=!1;break;case je.GETTING:e.semaphore.fetching.item.forEach((function(r,n){r===C.default(t,"id","notValid")&&e.semaphore.fetching.item.splice(n,1)}));break;case je.UPDATING:e.semaphore.updating.forEach((function(r,n){r===C.default(t,"id","notValid")&&e.semaphore.updating.splice(n,1)}))}})),J(Ve,"RESET_STATE",(function(e){Object.assign(e,xt)})),Ve)},Ct={install:function(e,r){void 0!==r.originName?e.Model.prototype.$devicesModuleOrigin=r.originName:e.Model.prototype.$devicesModuleOrigin=t.ModuleOrigin.MODULE_DEVICES_ORIGIN,r.database.register(_e,Qe),r.database.register(ve,nt),r.database.register(we,st),r.database.register(ke,ft),r.database.register(Ae,gt),r.database.register(Ne,bt),r.database.register(Ie,Dt),r.database.register(Oe,Mt)}};return e.default=Ct,Object.defineProperty(e,"__esModule",{value:!0}),e}({},modulesMetadata,core,capitalize,exchangeEntitySchema,Jsona,Ajv,uuid,get,uniq,simplePropertyMappers,clone,exchangeEntitySchema$1,exchangeEntitySchema$2,exchangeEntitySchema$3,exchangeEntitySchema$4,exchangeEntitySchema$5,exchangeEntitySchema$6,exchangeEntitySchema$7);